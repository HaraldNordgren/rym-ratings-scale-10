var g_keyCodes={esc:27,ret:13,comma:188,backslash:191,slash:220,pageUp:33,pageDown:34,end:35,"home.safari":63273,home:36,backspace:8,up:38,down:40};function updateStyleThemeLabels(){var a=window.themes.indexOf(window.localStorage.theme);a!=-1?$("#page_frame_theme_switch").html(window.themes_label[a]):$("#page_frame_theme_switch").html("Auto"),window.localStorage.size_mode?$("#page_frame_size_mode_switch").html("Compact"):$("#page_frame_size_mode_switch").html("Normal")}function updateTheme(){var a="";for(var e in window.themes)a+=" theme_"+window.themes[e];if(!window.localStorage.theme){var m="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(m="eve"),$("html, body").removeClass(a).addClass("theme_"+m)}}function switchSizeMode(a){a.stopPropagation();var e=["smaller"],m=["Compact"],i="";for(var o in e)i+=" size_mode_"+e[o];var t=e.indexOf(window.localStorage.size_mode);if(t++,t>=e.length){$("#page_frame_size_mode_switch").html("Normal"),delete window.localStorage.size_mode,$("html, body").removeClass(i).addClass("size_mode_normal");return}$("#page_frame_size_mode_switch").html(m[t]),window.localStorage.size_mode=e[t],$("html, body").removeClass(i).addClass("size_mode_"+e[t])}function switchTheme(a,e){a&&a.stopPropagation();var m="";for(var i in window.themes)m+=" theme_"+window.themes[i];var o;if(e?window.localStorage.theme==e?o=window.themes.length:o=window.themes.indexOf(e):(o=window.themes.indexOf(window.localStorage.theme),o++),o>=window.themes.length){$("#page_frame_theme_switch").html("Auto"),delete window.localStorage.theme;var t="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(t="eve"),$("html, body").removeClass(m).addClass("theme_"+t);return}$("#page_frame_theme_switch").html(window.themes_label[o]),window.localStorage.theme=window.themes[o],$("html, body").removeClass(m).addClass("theme_"+window.themes[o])}rymQ(function(){$(".has_tip").tipTip(),$(".timeago").timeago()});
 
function dayMonth(a){var _=new Date(a),h=_.getDate(),l=_.getMonth(),J=["January","February","March","April","May","June","July","August","September","October","November","December"];return h+" "+J[l]}function dayMonthShort(a){var _=new Date(a),h=_.getDate(),l=_.getMonth(),J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return h+" "+J[l]}String.prototype.fuzzyTime=function(a){ago=this,a=a||{},this.days=a.days||"d",this.hours=a.hours||"h",this.minutes=a.minutes||"m",this.on=a.on||"",this.ago=ago,this.setMonthArray=a.setMonthArray||["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.setMinDays=a.setMinDays||30,this.dateFormat=a.dateFormat||{};var _=new Date,h=new Date(ago),l=_-h;l/=1e3;var J=Math.round(l%60);l=Math.floor(l/60);var F=Math.round(l%60);l=Math.floor(l/60);var z=Math.round(l%24);l=Math.floor(l/24);var b=l;this.formatDate=function(){var N=this.ago,O=this.setMonthArray,I=new Date(N),i=I.getDate(),e=I.getMonth(),t=I.getFullYear();return this.dateFormat=="simple"?N=O[e]+" "+i+"' "+t.toString().slice(2):N=i+" "+O[e]+" "+t};var p;return b!=0?b<this.setMinDays?z!=0?p=b+this.days:p=b+this.days:p=this.on+" "+this.formatDate():z!=0?p=z+this.hours:F==0?p="now":p=F+this.minutes,p},String.prototype.toHHMMSS=function(){var a=parseInt(this,10);if(!a)return"";var _=Math.floor(a/3600),h=Math.floor((a-_*3600)/60),l=a-_*3600-h*60;return h<10&&(h="0"+h),l<10&&(l="0"+l),_+":"+h+":"+l},String.prototype.toMMSS=function(){var a=parseInt(this,10);if(!a)return"";var _=Math.floor(a/60),h=a-_*60;return h<10&&(h="0"+h),_+":"+h},String.prototype.abbreviateNumber=function(a){a=a||1e3;var _=parseInt(this);if(_<a)return _;var h=["","k","M"],l=Math.log10(_)/3|0;if(l==0)return _;var J=h[l],F=Math.pow(10,l*3),z=_/F,b=1;return _>1e4&&(b=0),b=0,z.toFixed(b)+J},Math.log10=Math.log10||function(a){return Math.log(a)*Math.LOG10E};var Hogan=Hogan||{};(function(a){a.Template=function(i,e,t,r){i=i||{},this.r=i.code||this.r,this.c=t,this.options=r||{},this.text=e||"",this.partials=i.partials||{},this.subs=i.subs||{},this.ib()},a.Template.prototype={r:function(i,e,t){return""},v:O,t:N,render:function(e,t,r){return this.ri([e],t||RYMtemplate,r)},ri:function(i,e,t){return this.r(i,e,t)},ep:function(i,e){var t=this.partials[i],r=e[t.name];if(t.instance&&t.base==r)return t.instance;if(typeof r=="string"){if(!this.c)throw new Error("No compiler available.");r=this.c.compile(r,this.options)}return r?(this.partials[i].base=r,t.subs&&(this.activeSub===void 0&&(e.stackText=this.text),r=h(r,t.subs,t.partials,e.stackText||this.text)),this.partials[i].instance=r,r):null},rp:function(i,e,t,r){var f=this.ep(i,t);return f?f.ri(e,t,r):""},rs:function(i,e,t){var r=i[i.length-1],f,g,s;if(typeof r=="function"&&(f=r,r=i[i.length-2],g=this.buf.length),!I(r))t(i,e,this);else for(var u=0;u<r.length;u++)i.push(r[u]),t(i,e,this),i.pop();f&&(s=this.buf.substr(g),this.buf=this.buf.substr(0,g),this.b(f(s)))},s:function(i,e,t,r){if(I(i)&&i.length===0)return!1;var f;typeof i=="function"&&(i=this.ms(i,e,t),typeof i=="function"&&(f=i));var g=!!i;return!r&&g&&e&&(f?e.push(f):e.push(typeof i=="object"?i:e[e.length-1])),g},d:function(i,e,t,r){var f,g=i.split("."),s=this.f(g[0],e,t,r),u=this.options.modelGet,M=null;if(i==="."&&I(e[e.length-2]))s=e[e.length-1];else for(var A=1;A<g.length;A++)f=_(e,A,g[A],s,u),f!=null?(M=s,s=f):s="";return r&&!s?!1:(!r&&typeof s=="function"&&(e.push(M),s=this.mv(s,e,t),e.pop()),s)},f:function(i,e,t,r){for(var f=!1,g=null,s=!1,u=this.options.modelGet,M=e.length-1;M>=0;M--)if(g=e[M],f=_(e,M,i,g,u),f!=null){s=!0;break}return s?(!r&&typeof f=="function"&&(f=this.mv(f,e,t)),f):r?!1:""},b:function(i){this.buf+=i},fl:function(){var i=this.buf;return this.buf="",i},ib:function(){this.buf=""},ms:function(i,e,t){var r=e[e.length-1];return i.call(r)},mv:function(i,e,t){var r=e[e.length-1];return i.call(r)},sub:function(i,e,t,r){var f=this.subs[i];f&&(this.activeSub=i,f(e,t,this,r),this.activeSub=!1)}};function _(i,e,t,r,f){var g,s;if(r&&(typeof r=="object"||typeof r=="string"||typeof r=="number")){if(t[0]==="="){var u=t.substring(1);return r.toString()==u}if(t[0]===">"&&t[1]==="="){var u=parseInt(t.substring(2));return parseInt(r.toString())>=u}if(t[0]===">"){var u=parseInt(t.substring(1));return parseInt(r.toString())>u}if(t[0]==="<"){var u=parseInt(t.substring(1));return parseInt(r.toString())<u}if(t[0]==="<"&&t[1]==="="){var u=parseInt(t.substring(2));return parseInt(r.toString())<=u}if(t.indexOf("is_one_of=")==0){var u=t.substring(10).split(",");return u.indexOf(r)!=-1}if(t[0]==="["){var M=parseInt(t.substring(1,t.length-1));if(Number.isInteger(M))return r[M]}if(typeof r=="number"&&t==="comma")return r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");if(typeof r=="number"&&t==="decimal_0")return parseFloat(Math.round(r*100)/100).toFixed(0);if(typeof r=="number"&&t==="decimal_1")return parseFloat(Math.round(r*100)/100).toFixed(1);if(typeof r=="number"&&t==="decimal_2")return parseFloat(Math.round(r*100)/100).toFixed(2);if(typeof r=="number"&&t==="singular")return r==1;if(typeof r=="number"&&t==="greater_than_1")return r>1;if(typeof r=="number"&&t==="minus_1")return r-1;if(typeof r=="number"&&t==="duration_hhmmss")return(r+"").toHHMMSS();if(typeof r=="number"&&t==="duration_mmss")return(r+"").toMMSS();if(t==="uppercase")return r.toUpperCase();if(t==="lowercase")return r.toLowerCase();if(t==="cap_first_word")return r.charAt(0).toUpperCase()+r.slice(1);if(t==="first_item")return r[0];if(t==="item_2")return r[1];if(t==="item_3")return r[2];if(t==="item_4")return r[3];if(t==="last_item")return r[r.length-1];if(t==="all_but_last")return r.slice(0,r.length-1);if(t==="first_1")return r.slice(0,1);if(t==="first_2")return r.slice(0,2);if(t==="first_3")return r.slice(0,3);if(t==="first_4")return r.slice(0,4);if(t==="first_5")return r.slice(0,5);if(t==="first_10")return r.slice(0,10);if(t==="first_15")return r.slice(0,15);if(t==="first_20")return r.slice(0,20);if(t==="first_25")return r.slice(0,25);if(t==="rest_1")return r.slice(1);if(t==="rest_2")return r.slice(2);if(t==="rest_3")return r.slice(3);if(t==="rest_4")return r.slice(4);if(t==="rest_5")return r.slice(5);if(t==="rest_10")return r.slice(10);if(t==="rest_15")return r.slice(15);if(t==="rest_25")return r.slice(25);if(t==="is_positive")return r>0;if(t==="has_one_item")return r.length===1;if(t==="has_expand_1")return r.length>1;if(t==="has_expand_2")return r.length>2;if(t==="has_expand_3")return r.length>3;if(t==="has_expand_4")return r.length>4;if(t==="has_expand_5")return r.length>5;if(t==="has_expand_10")return r.length>10;if(t==="has_expand_15")return r.length>15;if(t==="has_expand_20")return r.length>20;if(t==="has_expand_25")return r.length>25;if(t==="abbreviated_num")return(r+"").abbreviateNumber();if(t==="abbreviated_num_10k")return(r+"").abbreviateNumber(1e4);if(t==="medium_length")return r.length>15&&r.length<=30;if(t==="long_length")return r.length>30&&r.length<=45;if(t==="extralong_length")return r.length>45;if(t==="join_with_comma")return r.join(", ");if(t==="join_with_slash")return r.join("/ ");if(t==="ref_object")return r.split(".")[0];if(t==="ref_assoc_id")return r.split(".")[1];if(t==="format_name"){var A=[];return A.push(r.name_display),r.type=="city"&&r.region_short_name.length>0&&A.push(r.region_short_name),(r.type=="city"||r.type=="region")&&A.push(r.country_name_display),A.join(", ")}if(t==="format_start_date_long"){var m=r[0],d=r[1],w=r[2],D="_January_February_March_April_May_June_July_August_September_October_November_December".split("_");if(m&&d&&w)return""+w+" "+D[d]+" "+m;if(m&&d)return""+D[d]+" "+m;if(m)return""+m}if(t==="format_start_date"){var m=r[0],d=r[1],w=r[2],D="_Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");if(m&&d&&w)return""+w+" "+D[d]+" "+m;if(m&&d)return""+D[d]+" "+m;if(m)return""+m}if(t==="format_end_date"){var m=r[4],d=r[5],w=r[6],D="_Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");if(m&&d&&w)return""+w+" "+D[d]+" "+m;if(m&&d)return""+D[d]+" "+m;if(m)return""+m}if(t==="format_release_type"){var B={album:"Album",ep:"EP",comp:"Compilation",single:"Single",video:"Video",unauth:"Bootleg",mixtape:"Mixtape",musicvideo:"Music video",additional:"Additional releases",unreleased_song:"Unreleased song",djmix:"DJ Mix"};return B[r]}if(t==="stringify_current")return JSON.stringify(i[i.length-1]);if(t==="stringify")return JSON.stringify(r,null,2);if(t==="stringify_json_string")return JSON.stringify(JSON.parse(r),null,2);if(t==="escape_for_js")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="plus_one")return r+1;if(t==="minus_one")return r-1;if(t==="fuzzytime")return r.fuzzyTime();if(t==="fuzzytime_longform")return r.fuzzyTime({setMonthArray:["January","February","March","April","May","June","July","August","September","October","November","December"]});if(t==="dayMonth")return dayMonth(r);if(t==="dayMonthShort")return dayMonthShort(r);if(t==="random_360")return Math.floor(Math.random()*360);if(t==="img_75")return r.replace(/\{\{size\}\}/g,"75");if(t==="img_150")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="img_300")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="img_600")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="img_900")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="image_aspect_ratio")return r.dimensions?r.dimensions[0]/r.dimensions[1]:1;if(t==="image_id_from_path")return r[1];if(t==="mime_type_from_path")return"image/"+r[0];if(t==="encode_for_image_filename")return encodeURIComponent(r).split(".").join("_");if(t==="urlencode")return encodeURIComponent(r);if(t==="extension_from_path")return r[0];if(t==="dir_for_size_1x"){for(var n in i)if(i[n].image_config&&i[n].image_config.size_1x)return i[n].image_config.size_1x>300?r[3]:r[2];throw new Error("No image config passed into template, which is required to render a template that shows images")}if(t==="dir_for_size_2x"){for(var n in i)if(i[n].image_config&&i[n].image_config.size_2x)return i[n].image_config.size_2x>300?r[3]:r[2];return r.sm}if(t==="release_is_collab"){for(var n in i)if(i[n].release_type&&i[n].release_type[1]==="collab")return!0;return!1}if(t==="format_extract_credited_name")return(""+(r[1]||"")+(r[2]||"")+r[0]).trim();if(t==="get_locale_name"){var j=r.aka_text?[r.aka_text]:r.original,o={main:(""+(j[1]||"")+(j[2]||"")+j[0]).trim()};for(var n in i)if(i[n].user_vars&&i[n].user_vars.options){var T=i[n].user_vars.options,G=T.user_langs;if(T.artist_loc_display)switch(T.artist_loc_display){case"show_both":case"show_user_lang":for(var n in G){var H=G[n];if(r.language&&r.language[H]){var C=r.language[H],$=(""+(C[1]||"")+(C[2]||"")+C[0]).trim();T.artist_loc_display==="show_both"?o.secondary=$:o.main=$}}}}return o}if(t==="music_primary_links"){for(var n in i)if(i[n].release_type){var P=i[n].release_type.indexOf("collab")!=-1,o=[],U=0;if(r.composers&&r.composers.length){if(U=r.composers.length,U==1)o.push(r.composers[0]);else if(U<=2)o=r.composers;else{var V=r.composers[0];o.push(V)}if(o.length==1&&r.performers&&r.performers.length<=2)for(var R in r.performers)r.composers.filter(function(Q){return Q.ref===r.performers[R].ref}).length==0&&o.push(r.performers[R])}else r.performers&&r.performers.length&&(o=r.performers);var L=o.length;for(var v in o){var q=parseInt(v);q===L-2?P?o[v].add_and=!0:o[v].add_slash=!0:q<L-2&&(P?o[v].add_comma=!0:o[v].add_slash=!0)}return r.name&&(o=[o[0]],o[0].name={original:{name:r.name}}),{links:o}}return[]}if(t==="blocked_by_flags"){let S=r.flags;if(!S)for(var n in i){if(i[n].flags){S=i[n].flags;break}if(i[n].main)break}if(!S||S.length==0)return!1;if(r.force_block_image)return!0;for(var n in i){if(i[n].force_block_image)return!0;if(i[n].user_vars){var Y=i[n].user_vars.options.image_flags;for(var v in S)if(Y.indexOf(S[v])==-1)return!0;return!1}if(i[n].image_config&&i[n].image_config.blocked_flags){var E=i[n].image_config.blocked_flags;for(var v in S)if(E.indexOf(S[v])!=-1)return!0;return!1}if(i[n].blocked_flags){var E=i[n].blocked_flags;for(var v in S)if(E.indexOf(S[v])!=-1)return!0;return!1}}return!0}r[t]!=null?g=r[t]:f&&r.get&&typeof r.get=="function"&&(g=r.get(t))}return g}function h(i,e,t,r){function f(){}f.prototype=i;function g(){}g.prototype=i.subs;var s,u=new f;u.subs=new g,u.subsText={},u.ib();for(s in e)u.subs[s]=e[s],u.subsText[s]=r;for(s in t)u.partials[s]=t[s];return u}var l=/&/g,J=/</g,F=/>/g,z=/\'/g,b=/\"/g,p=/[&<>\"\']/;function N(i){return String(i==null?"":i)}function O(i){return i=N(i),p.test(i)?i.replace(l,"&amp;").replace(J,"&lt;").replace(F,"&gt;").replace(z,"&#39;").replace(b,"&quot;"):i}var I=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"}})(typeof exports!="undefined"?exports:Hogan);
 
/**
 * Timeago is a jQuery plugin that makes it easy to support automatically
 * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").
 *
 * @name timeago
 * @version 0.11.4
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 *
 * For usage and examples, visit:
 * http://timeago.yarp.com/
 *
 * Copyright (c) 2008-2012, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
 */(function(n){n.timeago=function(t){return t instanceof Date?_(t):typeof t=="string"?_(n.timeago.parse(t)):typeof t=="number"?_(new Date(t)):_(n.timeago.datetime(t))};var g=n.timeago;n.extend(n.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:"+",suffixAgo:null,suffixFromNow:null,justnow:"now",justnow_long:"just now",seconds:"%d sec",seconds_long:"%d seconds ago",minute:"1m",minute_long:"1 minute ago",minutes:"%dm",minutes_long:"%d minutes ago",hour:"1h",hour_long:"1 hour ago",hours:"%dh",hours_long:"%d hours ago",day:"1d",day_long:"1 day ago",days:"%dd",days_long:"%d days ago",wordSeparator:" ",numbers:[]}},inWords:function(t,e,d,v,l,f,N){var r=this.settings.strings,J=r.prefixAgo,C=r.suffixAgo;this.settings.allowFuture&&e<0&&(J=r.prefixFromNow,C=r.suffixFromNow);var o=Math.abs(e)/1e3,s=o/60,i=s/60,h=i/24,Y=h/365;function a(D,x){var S=n.isFunction(D)?D(x,e):D,j=r.numbers&&r.numbers[x]||x;return S.replace(/%d/i,j)}var c;if(d?c=o<15&&a(r.justnow_long,Math.round(o))||o<45&&a(r.seconds_long,Math.round(o))||o<90&&a(r.minute_long,1)||s<45&&a(r.minutes_long,Math.round(s))||s<90&&a(r.hour_long,1)||i<24&&a(r.hours_long,Math.round(i))||i<42&&a(r.day_long,1)||h<30&&a(r.days_long,Math.round(h)):l?c=o<15&&a(r.justnow,Math.round(o))||o<45&&a(r.seconds,Math.round(o))||o<90&&a(r.minute,1)||s<45&&a(r.minutes,Math.round(s))||s<90&&a(r.hour,1)||i<24&&a(r.hours,Math.round(i))||i<42&&a(r.day,1)||a(r.days,Math.round(h)):c=o<15&&a(r.justnow,Math.round(o))||o<45&&a(r.seconds,Math.round(o))||o<90&&a(r.minute,1)||s<45&&a(r.minutes,Math.round(s))||s<90&&a(r.hour,1)||i<24&&a(r.hours,Math.round(i))||i<42&&a(r.day,1)||h<30&&a(r.days,Math.round(h)),N){var u=new Date(new Date().getTime()-e),w=new Date,y=u.getMonth(),M=u.getDate(),m="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),p=u.getFullYear(),T=w.getFullYear();return M+" "+m[y]+" "+p+", "+t.toLocaleTimeString()}else if(!l&&(f||e>1e3*60*60*24*30)){var u=new Date(new Date().getTime()-e),w=new Date,y=u.getMonth(),M=u.getDate(),m;d||v?m="January_February_March_April_May_June_July_August_September_October_November_December".split("_"):m="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");var p=u.getFullYear(),T=w.getFullYear();return M+" "+m[y]+" "+(p===T?"":p)}else{if(l&&h>365){var u=new Date(new Date().getTime()-e);return""+u.getFullYear()}var W=r.wordSeparator===void 0?" ":r.wordSeparator;return n.trim(c)}},parse:function(t){var e=n.trim(t);return e=e.replace(/\.\d+/,""),e=e.replace(/T/," ").replace(/Z/," UTC"),e=e.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),e=e.replace(/\s/,"T"),e=e.replace(/\+00/,""),e+="Z",new Date(e)},datetime:function(t){var e=g.isTime(t)?n(t).attr("datetime"):n(t).attr("title");return e.indexOf(" ")>-1?n.trim(g.parse(e)):new Date(e)},isTime:function(t){return n(t).get(0).tagName.toLowerCase()==="time"}}),n.fn.timeago=function(){var t=this;t.each(F);var e=g.settings;return e.refreshMillis>0&&setInterval(function(){t.each(F)},e.refreshMillis),t};function F(){var t=n(this).hasClass("longform"),e=n(this).hasClass("fullmonth"),d=n(this).hasClass("days_or_year"),v=n(this).hasClass("dateonly"),l=n(this).hasClass("datetime"),f=b(this);return isNaN(f.datetime)||n(this).text(n.trim(_(f.datetime,t,e,d,v,l))),this}function b(t){if(t=n(t),!t.data("timeago")){t.data("timeago",{datetime:g.datetime(t)});var e=n.trim(t.text());if(e.length>0&&!(g.isTime(t)&&t.attr("title"))){var d=g.datetime(t).toString();t.attr("title","").attr("data-tiptip",d).addClass("has_tip").tipTip()}}return t.data("timeago")}function _(t,e,d,v,l,f){return g.inWords(t,A(t),e,d,v,l,f)}function A(t){return new Date().getTime()-t.getTime()}})(jQuery),rymQ(function(){$(".timeago").timeago()});
 
(function(o){o.fn.tipTip=function(y){var P={activation:"hover",keepAlive:!1,maxWidth:"1200px",edgeOffset:3,defaultPosition:"bottom",delay:200,fadeIn:200,fadeOut:200,attribute:"data-tiptip",content:!1,enter:function(){},exit:function(){}},t=o.extend(P,y);if(o("#tiptip_holder").length<=0){var i=o('<div id="tiptip_holder" style="pointer-events:none;max-width:'+t.maxWidth+';"></div>'),g=o('<div id="tiptip_content"></div>'),_=o('<div id="tiptip_arrow"></div>');o("body").append(i.html(g).prepend(_.html('<div id="tiptip_arrow_inner"></div>')))}else var i=o("#tiptip_holder"),g=o("#tiptip_content"),_=o("#tiptip_arrow");return this.each(function(){var r=o(this);if(t.content)var b=t.content;else var b=r.attr(t.attribute);if(b!=""){let h=function(){t.enter.call(this),g.html(b),i.hide().removeAttr("class").css("margin","0"),_.removeAttr("style");var n=parseInt(r.offset().top),l=parseInt(r.offset().left),x=parseInt(r.outerWidth()),u=parseInt(r.outerHeight()),d=i.outerWidth(),f=i.outerHeight(),m=Math.round((x-d)/2),I=Math.round((u-f)/2),v=Math.round(l+m),a=Math.round(n+u+t.edgeOffset),e="",c="",w=Math.round(d-12)/2;t.defaultPosition=="bottom"?e="_bottom":t.defaultPosition=="top"?e="_top":t.defaultPosition=="left"?e="_left":t.defaultPosition=="right"&&(e="_right");var A=m+l<parseInt(o(window).scrollLeft()),k=d+l>parseInt(o(window).width());A&&m<0||e=="_right"&&!k||e=="_left"&&l<d+t.edgeOffset+5?(e="_right",c=Math.round(f-13)/2,w=-12,v=Math.round(l+x+t.edgeOffset),a=Math.round(n+I)):(k&&m<0||e=="_left"&&!A)&&(e="_left",c=Math.round(f-13)/2,w=Math.round(d),v=Math.round(l-(d+t.edgeOffset+5)),a=Math.round(n+I));var M=n+u+t.edgeOffset+f+8>parseInt(o(window).height()+o(window).scrollTop()),O=n+u-(t.edgeOffset+f+8)<0;M||e=="_bottom"&&M||e=="_top"&&!O?(e=="_top"||e=="_bottom"?e="_top":e=e+"_top",c=f,a=Math.round(n-(f+5+t.edgeOffset))):(O|(e=="_top"&&O)||e=="_bottom"&&!M)&&(e=="_top"||e=="_bottom"?e="_bottom":e=e+"_bottom",c=-12,a=Math.round(n+u+t.edgeOffset)),e=="_right_top"||e=="_left_top"?a=a+5:(e=="_right_bottom"||e=="_left_bottom")&&(a=a-5),(e=="_left_top"||e=="_left_bottom")&&(v=v+5),_.css({"margin-left":w+"px","margin-top":c+"px"}),i.css({"margin-left":v+"px","margin-top":a+"px"}).attr("class","tip"+e),p&&clearTimeout(p),p=setTimeout(function(){i.stop(!0,!0).fadeIn(t.fadeIn)},t.delay)},s=function(){t.exit.call(this),p&&clearTimeout(p),i.fadeOut(t.fadeOut)};var T=h,W=s;t.content||r.removeAttr(t.attribute);var p=!1;t.activation=="hover"?(r.hover(function(){h()},function(){t.keepAlive||s()}),t.keepAlive&&i.hover(function(){},function(){s()})):t.activation=="focus"?r.focus(function(){h()}).blur(function(){s()}):t.activation=="click"&&(r.click(function(){return h(),!1}).hover(function(){},function(){t.keepAlive||s()}),t.keepAlive&&i.hover(function(){},function(){s()}))}})}})(jQuery);
 
var d=(e,t,a)=>new Promise((r,s)=>{var i=o=>{try{n(a.next(o))}catch(l){s(l)}},c=o=>{try{n(a.throw(o))}catch(l){s(l)}},n=o=>o.done?r(o.value):Promise.resolve(o.value).then(i,c);n((a=a.apply(e,t)).next())});function openShortcut(e){currentElement=e;var t=$(e).offset(),a=$("#shortcut").outerWidth(),r=$(window).outerWidth(),s=t.left+$(e).outerWidth();s+a>r&&(s=r-a),$("#shortcut").css("top",t.top+"px").css("left",s+"px").show(),shortcut_first_sc&&shortcut_first_sc!=""&&viewshortcut(shortcut_first_sc,shortcut_first_func)}function did(e){return document.getElementById(e)}function RYMSession(){this.userid=0,this.username="",this.token="",this.init=function(e,t,a,r){this.userid=e,this.username=t,this.token=a,this.images=r},this.logout=function(){this.userid=0,this.username="",this.token=""},this.isLoggedIn=function(){return this.userid!=0},this.agreeRules=function(e){$.ajax({url:"/api/1/rules/"+e,method:"POST",dataType:"json",data:{category:e,action:"agree"},success:function(t,a,r){rym.closeModal(),rym.session.rules_agreed=t.rules_agreed,rym.session.rulesCallback()}})},this.confirmRules=function(e,t){this.rulesCallback=t,this.rules_agreed[e]&&t()}}var RYMresource={};function RYMRequest(){this.sendRequest=function(requestType,data,callback,dataType,cache,url){cache==null&&(cache=!1),url==null&&(url="/httprequest/"+data.action),data.rym_ajax_req=1,data.request_token=rym.session.token;var form_data=new FormData;for(var key in data)form_data.append(key,data[key]);fetch(url,{method:requestType,body:form_data}).then(function(response){dataType==="script"?response.text().then(data=>{eval(data)}):dataType=="json"?response.json().then(e=>{callback(e)}):alert(dataType)})},this.post=function(e,t,a,r,s,i){return t.action=e,r=r||"script",this.sendRequest("POST",t,a,r,s,i)},this.api=function(e,t,a){var r={method:e.toUpperCase(),cache:"no-cache",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${rym.session.token}`},redirect:"error",referrerPolicy:"origin"};switch(e){case"GET":var s=new URLSearchParams(a).toString();s.length&&(t+=`?${s}`);break;case"POST":case"PUT":case"DELETE":r.body=JSON.stringify(a);break}return fetch(t,r).then(i=>i)}}function RYM(){this.session=new RYMSession,this.request=new RYMRequest,this.modalDirty=!1,this.doModalLoading=function(){$("#modal_content").show().loadingAnim(),$("#modal_parent_frame")[0].style.display="flex",$("#modal_overlay").show(),$("html").addClass("modal_active")},this.markModalDirty=function(){this.modalDirty=!0},this.closeModal=function(){this.modalDirty&&!confirm("Are you sure you want to close this dialog? Press OK to confirm.")||($("#modal_parent_frame").hide(),$("#modal_content").html(""),$("#modal_overlay").fadeOut(100),$("html").removeClass("modal_active"),$("#body").off("keydown"),this.modalDirty=!1)},this.doModal=function(e,t,a){return d(this,null,function*(){a=a||{},a=Object.assign({mode:"message",frame_class:"standard"},a),$("#modal_parent_frame_inner")[0].className="modal_parent_frame_inner modal_parent_frame_inner_"+a.frame_class,$("#modal_parent_frame")[0].style.display="flex",$("#modal_overlay").show(),$("html").addClass("modal_active"),renderTemplate("ui.modal",{title:t,body:e,frame_class:a.frame_class}).then(r=>{$("#modal_content").html(r).show().addClass(),$("#body").on("keydown",function(s){if(s&&s.keyCode)switch(s.keyCode){case g_keyCodes.esc:return rym.closeModal(),!1;break}})})})},this.doModal2=function(e,t,a){return d(this,null,function*(){a=a||{},a=Object.assign({mode:"message",frame_class:"standard"},a),$("#modal_parent_frame_inner_level_2")[0].className="modal_parent_frame_inner modal_parent_frame_inner_"+a.frame_class,$("#modal_parent_frame_level_2")[0].style.display="flex",$("#modal_overlay_level_2")[0].style.display="flex",$("html").addClass("modal_active"),renderTemplate("ui.modal",{title:t,body:e,frame_class:a.frame_class}).then(r=>{$("#modal_content_level_2").html(r).show().addClass(),$("#body").on("keydown",function(s){if(s&&s.keyCode)switch(s.keyCode){case g_keyCodes.esc:return rym.closeModal2(),!1;break}})})})},this.closeModal2=function(){$("#modal_parent_frame_level_2").hide(),$("#modal_content_level_2").html(""),$("#modal_overlay_level_2").hide(),$("#modal_parent_frame").is(":visible")||$("html").removeClass("modal_active"),$("#body").on("keydown",function(e){if(e&&e.keyCode)switch(e.keyCode){case g_keyCodes.esc:return rym.closeModal(),!1;break}})},this.clearGlobalError=function(){$("#header_error").hide()},this.showGlobalError=function(e){$("#header_error_text").html(e),$("#header_error").fadeIn(100).fadeOut(10).fadeIn(100),$("#submitbtn")&&$("#submitbtn").prop("disabled",!1)},this.showGlobalMessage=function(e){$("#header_message_text").html(e),$("#header_message").fadeIn(100),$("#submitbtn")&&$("#submitbtn").prop("disabled",!1)},this.setupPage=function(){$(".timeago").timeago(),$(".has_tip").tipTip(),$(".ui_textarea").textareaUI(),$(".page_section_dynamic_fade").dynamicFadeSectionUI()}}rym=new RYM;
 
var RYMdynamicSection={initFade:function(i){var n=i.data("dynamic-fade-initialized");if(!n){i.data("dynamic-fade-initialized",!0);var t=i[0].id,a=i.outerHeight(),e=i[0].scrollHeight;e-50>a?(i.find(".page_section_dynamic_fade_cover").show(),i.find(".page_section_dynamic_fade_expand_button").show().unbind().on("click",function(){i.toggleClass("expanded")})):i.removeClass("page_section_dynamic_fade")}},initList:function(i){}};$.fn.extend({dynamicFadeSectionUI:function(){$(this).each(function(i){RYMdynamicSection.initFade($(this))})}}),rymQ(function(){$(".page_section_dynamic_fade").dynamicFadeSectionUI()});
 
var RYMheader={onClickBars:function(){if($("#header_extended_section").is(":visible")){RYMheader.dismissDesktopMenu();return}$("#mobile_header_menu").addClass("fixed"),$("#header_extended_section").show(),$("#content_cover").css({width:"100%",height:$(document).height(),top:0,left:0}).show().on("click",function(){RYMheader.dismissDesktopMenu()})},dismissDesktopMenu:function(){$("#content_cover").off("click").hide(),$("#header_extended_section").fadeOut(50),$("#mobile_header_menu").removeClass("fixed")},toggleMobileMenu:function(){$("#content_cover").is(":visible")?RYMheader.hideMobileMenu():RYMheader.showMobileMenu()},showMobileMenu:function(){$("#header_expanded").show(),$("#mobile_header_menu").addClass("fixed");var e=$(document).height()+"px";$("#content_cover").css({width:"100%",height:e,top:"6em",left:0}).show().on("click",function(){RYMheader.hideMobileMenu()})},hideMobileMenu:function(){$("#header_expanded").hide(),$("#mobile_header_menu").removeClass("fixed"),$("#content_cover").hide().off("click")}};
 
var RYMmobile={mobileMenu:{enterSelectionMode:function(){$(".mobile_menu")[0].className="mobile_menu selection_mode"},exitSelectionMode:function(){$(".mobile_menu")[0].className="mobile_menu"}},mobileExpand:{toggleFull:function(e){$("#expand_full_"+e).toggleClass("expanded")},toggleSection:function(e){$("#expand_section_"+e).toggleClass("expanded")},toggleFade:function(e){$("#expand_fade_"+e).toggleClass("expanded")}}},RYMdynamicSection={initFade:function(e){var i=e.data("dynamic-fade-initialized");if(!i){e.data("dynamic-fade-initialized",!0);var t=e[0].id,n=e.outerHeight(),a=e[0].scrollHeight;a-50>n?(e.find(".page_section_dynamic_fade_cover").show(),e.find(".page_section_dynamic_fade_expand_button").show().unbind().on("click",function(){e.toggleClass("expanded")})):e.removeClass("page_section_dynamic_fade")}},initList:function(e){}};$.fn.extend({dynamicFadeSectionUI:function(){$(this).each(function(e){RYMdynamicSection.initFade($(this))})}});
 
var l=(e,o,n)=>new Promise((t,a)=>{var r=i=>{try{s(n.next(i))}catch(p){a(p)}},c=i=>{try{s(n.throw(i))}catch(p){a(p)}},s=i=>i.done?t(i.value):Promise.resolve(i.value).then(r,c);s((n=n.apply(e,o)).next())});var RYMpagination={callback:function(e,o,n){let t=e.getAttribute("href"),a=e.parentNode;a.dataset.callbackComponent||(a=a.parentNode);let r=a.dataset.pageComponent;switch(a.dataset.callbackComponent){case"discography":switch(r){case"company_music.discography":case"genre.discography":return component.discography.onClickDiscographyPage(o,t,n)}break;case"charts":return page.charts.onClickChartsPage(o,t,n)}return window.history.pushState({},window.title,t),!1},openPageChooser:function(e){return l(this,null,function*(){$("#overlay_invisible").show().on("click",function(){RYMpagination.closePageChooser(e)}),$("#ui_pagination_page_chooser_"+e).show();for(var o='<div class="ui_pagination_page_chooser_row">',n=parseInt($("#ui_pagination_"+e).data("num-pages")),t=$("#ui_pagination_"+e).data("options"),a=1;a<=n;a++){a%10==0&&(o+='</div><div class="ui_pagination_page_chooser_row">');var r=t.url_template.replace("{{page}}",a);a==1&&(r=t.url_first_page);var c={url:r,num:a};o+=yield renderTemplate("ui.pagination.number",c)}o+="</div>",$("#ui_pagination_page_chooser_"+e).html(o)})},closePageChooser:function(e){$("#ui_pagination_page_chooser_"+e).hide(),$("#overlay_invisible").hide().off("click")}};
 
var h=(e,a,t)=>new Promise((s,l)=>{var r=o=>{try{n(t.next(o))}catch(i){l(i)}},c=o=>{try{n(t.throw(o))}catch(i){l(i)}},n=o=>o.done?s(o.value):Promise.resolve(o.value).then(r,c);n((t=t.apply(e,a)).next())});var RYMsearch={lastAjaxRequest:null,lastSearchValue:null,lastSearchTimer:null,lastSearchAbortController:null,searchDebounceInterval:50,resultCache:{},currentResultSet:{},currentSelectedItem:{},blurTimer:{},initState:{},selectedId:null,searchEndpoint:"https://api.sonemic.com/1/search",types:{Music:[{type:"music",name:"music",label:"Everything",searchlabel:"music"},{type:"a",name:"artist",label:"Artists",searchlabel:"artists"},{type:"l",name:"release",label:"Releases",searchlabel:"releases"},{type:"z",name:"song",label:"Songs",searchlabel:"songs"},{type:"y",name:"release",label:"V/A Releases",searchlabel:"va_releases"},{type:"b",name:"company_music",label:"Labels",searchlabel:"companies"},{type:"j",name:"catalog_no",label:"Catalog No.",searchlabel:"catalog_no"},{type:"h",name:"genre",label:"Genres",searchlabel:"music genres"},{type:"r",name:"work",label:"Works",searchlabel:"works"},{type:"u",name:"user",label:"Users",searchlabel:"user"},{type:"s",name:"list",label:"Lists",searchlabel:"list"}],Film:[{type:"films",name:"films",label:"Everything",searchlabel:"films"},{type:"F",name:"film",label:"Film titles",searchlabel:"film titles"},{type:"A",name:"film_person",label:"People",searchlabel:"cast/crew"},{type:"fg",name:"genre",label:"Genres",searchlabel:"film genres"}],Games:[{name:"games",label:"Everything",searchlabel:"games"},{name:"game",label:"Game titles",searchlabel:"game titles"},{name:"game_person",label:"People",searchlabel:"game persons"},{name:"company_game",label:"Companies",searchlabel:"game companies"},{name:"game_platform",label:"Platforms",searchlabel:"game platforms"},{name:"genre",label:"Genres",searchlabel:"game genres"},{name:"franchise",label:"Franchises",searchlabel:"franchises"},{name:"character",label:"Characters",searchlabel:"characters"},{name:"descriptor",label:"Descriptors",searchlabel:"game descriptors"},{name:"user",label:"Users",searchlabel:"user"},{name:"list",label:"Lists",searchlabel:"list"}],Community:[{name:"user",label:"Users",searchlabel:"users"},{name:"list",label:"Lists",searchlabel:"lists"}],location:[{name:"location",label:"Location",searchlabel:"location"}]},setHelpHeader:function(e,a){return h(this,null,function*(){let t="";$("#ui_search_results_"+e).html(t)})},initContextIndicator:function(e,a){var t="";switch(a){case"insertShortcut":var s=$("#ui_search_"+e).data("callback-id"),l=document.getElementById(s);if(l){var r=document.getElementById(s).selectionStart,c=$("#"+s).val();t=c.substring(0,r)+" [______]"}break;case"catalog":t="Catalog item...";break;case"addToList":t="Add to list...";break;default:t=""}$("#ui_search_context_indicator_inner_"+e).text(t)},init:function(e){var a=$("html, body").hasClass("scope_film")?"film":"music",t=$("#ui_search_"+e).data("callback");RYMsearch.selectScope(e,a),RYMsearch.setHelpHeader(e,"search"),RYMsearch.initContextIndicator(e,t),RYMsearch.initState[e]=!0;var s=$("#ui_search_input_"+e).val();s.length>0&&$("#ui_search_frame_"+e).addClass("has_content")},setDialogActive:function(e,a){RYMsearch.stopBodyScrolling(!a),a?(RYMsearch.lastBodyYOffset=document.body.scrollTop,$("#ui_search_frame_"+e).addClass("active")[0].scrollTop=0,$("html").addClass("modal_search_active"),$("#overlay_invisible").show().on("click",function(){RYMsearch.close(e)}),document.body.scrollTop=0):(document.body.scrollTop=RYMsearch.lastBodyYOffset,$("#ui_search_frame_"+e).removeClass("active"),$("html").removeClass("modal_search_active"),$("#overlay_invisible").hide().off("click"))},_freezeVp:function(e){e.preventDefault()},stopBodyScrolling:function(e){e===!0?document.body.addEventListener("touchmove",RYMsearch._freezeVp,!1):document.body.removeEventListener("touchmove",RYMsearch._freezeVp,!1)},onClickSuggestion:function(e){document.getElementById("ui_search_input_main_search").value=e.target.innerText,RYMsearch.redirSearch(e,"main_search")},_onSearchResults:function(e,a){return h(this,null,function*(){RYMsearch.lastSearchTimer=null;var t="",s=$("#ui_search_object_select_"+e).val();if(a.results.length===0)RYMsearch.setHelpHeader(e,"noresults");else{for(var l in a.results){t+='<div class="ui_search_object_category">',t+='<div class="ui_search_object_category_label">'+a.results[l].label_display,a.results[l].object!==s&&(t+=`<div onClick="RYMsearch.setObject('`+e+"', '"+a.results[l].object+`');" class="ui_search_object_category_only_btn">Only</div>`),t+="</div>";for(var r in a.results[l].items){var c=a.results[l].items[r];c.id=e,t+=yield renderTemplate("ui.search.result",c)}t+="</div>"}$("#ui_search_results_"+e).html(t),$(".has_tip").tipTip()}})},redirSearch:function(e,a){typeof e!="undefined"?wevt=e:window.event&&(wevt=window.event);var t=$("#ui_search_input_"+a).val(),s=$("#ui_search_scope_"+a).val(),l=$("#ui_search_object_select_"+a).val();(l==="music"||!l)&&(l=""),wevt&&(wevt.shiftKey||wevt.metaKey||e&&e.which==2)?window.open("/search?searchterm="+encodeURIComponent(t)+"&searchtype="+l,"_blank"):window.location="/search?searchterm="+encodeURIComponent(t)+"&searchtype="+l},doSearch:function(e){RYMsearch.lastSearchTimer&&(clearTimeout(RYMsearch.lastSearchTimer),RYMsearch.lastSearchTimer=null),RYMsearch.lastSearchTimer=setTimeout(()=>{RYMsearch._doSearch(e)},RYMsearch.searchDebounceInterval)},_doSearch:function(e){var a=$("#ui_search_input_"+e).val(),t=$("#ui_search_scope_"+e).val(),s=$("#ui_search_object_select_"+e).val(),l=$("#ui_search_"+e).data("config-string"),r=$("#ui_search_"+e).data("test-server");if(a.length==0){RYMsearch.setHelpHeader(e,"search");return}RYMsearch.lastSearchAbortController&&(RYMsearch.lastSearchAbortController.abort(),RYMsearch.lastSearchAbortController=null);const c=new URLSearchParams({searchterm:a,searchtype:s});if(a.length>0){RYMsearch.lastSearchAbortController=new AbortController;var n={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},signal:RYMsearch.lastSearchAbortController.signal};fetch(`/api/1/search/autocomplete?${c}`,n).then(function(o){return o.json()}).then(o=>h(this,null,function*(){document.getElementById("ui_search_results_main_search").innerHTML=yield renderTemplate("ui.search.autocomplete.results",{id:e,results:o})})).catch(o=>{o.name==="AbortError"||console.error("error:",o)})}else document.getElementById("ui_search_results_main_search").innerHTML=""},close:function(e){RYMsearch.setDialogActive(e,!1),$("#overlay_invisible").hide().off("click")},clearSearch:function(e){$("#ui_search_input_"+e).val(""),RYMsearch.setHelpHeader(e,"search"),$("#ui_search_frame_"+e).removeClass("has_content"),$("#ui_search_results_"+e).html("")},onEscape:function(e){let a=document.getElementById(`ui_search_input_${e}`);var t=$("#ui_search_input_"+e).val();t.length>0?RYMsearch.clearSearch(e):(RYMsearch.close(e),a&&a.blur())},onFocus:function(e,a){RYMsearch.setDialogActive(a,!0);var t=$("#ui_search_input_"+a).val();t.length&&RYMsearch.doSearch(a);var s=$("#ui_search_"+a).data("callback");RYMsearch.initContextIndicator(a,s),RYMsearch.initState[a]||RYMsearch.init(a),rym.nextSearchType&&($("#ui_search_object_select_"+a).val(rym.nextSearchType),rym.nextSearchType=null)},onClickClose:function(e,a){RYMsearch.close(a)},onClickClearSearch:function(e,a){RYMsearch.clearSearch(a),RYMsearch.setDialogActive(a,!1)},onBlur:function(e,a){RYMsearch.lastSearchTimer&&(clearTimeout(RYMsearch.lastSearchTimer),RYMsearch.lastSearchTimer=null),RYMsearch.lastSearchAbortController&&(RYMsearch.lastSearchAbortController.abort(),RYMsearch.lastSearchAbortController=null);var t=$("#ui_search_input_"+a).val();t.length==0},onKeyDownSuggestionButton:function(e,a){let s=document.getElementById(`ui_search_results_${a}`).querySelectorAll(".ui_search_autocomplete_result"),l=-1;for(let c=0;c<s.length;c++)s[c]===document.activeElement&&(l=c);let r=s[0];e.keyCode===g_keyCodes.up?(l!==0?r=s[l-1]:r=s[s.length-1],e.stopPropagation(),e.preventDefault(),r.focus()):e.keyCode===g_keyCodes.down?(l!==s.length-1&&l!==-1&&(r=s[l+1]),e.stopPropagation(),e.preventDefault(),r.focus()):e.keyCode===g_keyCodes.esc?(document.getElementById(`ui_search_input_${a}`).focus(),e.stopPropagation(),e.preventDefault()):e.keyCode===g_keyCodes.pageUp?(r=s[0],e.stopPropagation(),e.preventDefault(),r.focus()):e.keyCode===g_keyCodes.pageDown&&(r=s[s.length-1],e.stopPropagation(),e.preventDefault(),r.focus())},onKeyDown:function(e,a){if(e){let t=e.keyCode||e.charCode;if(t)switch(t){case g_keyCodes.esc:return RYMsearch.onEscape(a),!1;break;case g_keyCodes.up:return!1;case g_keyCodes.down:return RYMsearch.onKeyDownSuggestionButton(e,a);case g_keyCodes.ret:return RYMsearch.redirSearch(e,a),!1;case g_keyCodes.pageUp:return RYMsearch.onKeyDownSuggestionButton(e,a);case g_keyCodes.pageDown:return RYMsearch.onKeyDownSuggestionButton(e,a)}}},onInput:function(e,a){var t=$("#ui_search_input_"+a).val();t.length>0?($("#ui_search_frame_"+a).addClass("has_content"),$("#ui_search_results_frame_main_search").show(),RYMsearch.setDialogActive(a,!0)):($("#ui_search_frame_"+a).removeClass("has_content"),$("#ui_search_results_frame_main_search").hide()),RYMsearch.doSearch(a)},onClickShortcut:function(e,a){e.stopPropagation(),$("#ui_search_result_shortcut_frame_"+a).addClass("clicked");var t=$("#ui_search_result_shortcut_"+a);return t.focus(),t.select(),!1},setObject:function(e,a){$("#ui_search_object_select_"+e).val(a),RYMsearch.doSearch(e)},onChangeObject:function(e,a){if(window.rym.preserveSearchType){var t=$("html, body").hasClass("scope_film")?"film":"music";window.localStorage["last_searchtype_"+t]=$("#ui_search_object_select_"+a).val()}RYMsearch.doSearch(a)},selectScope:function(e,a){$("#ui_search_scope_selector_"+e+" .ui_search_scope_selector_item").removeClass("selected"),$("#ui_search_scope_selector_"+a+"_"+e).addClass("selected"),$("#ui_search_scope_"+e).val(a),RYMsearch.populateSelectGroup(e,a),RYMsearch.doSearch(e)},onClickSearchScope:function(e,a,t){RYMsearch.selectScope(a,t)},insertShortcut:function(e,a){var t=$("#ui_search_"+e).data("callback-id"),s=document.getElementById(t).selectionStart,l=$("#"+t).val(),r=l.substring(0,s);r[r.length-1]!==" "&&(r+=" ");var c=l.substring(s);c.length>0&&c[0]!==" "&&(c=" "+c),$("#"+t).val(r+"["+a+"]"+c).focus(),RYMsearch.clearSearch(e),RYMsearch.close(e)},onClickResult:function(e,a,t,s,l,r,c,n,o){var i=$("#ui_search_"+l).data("callback");if(typeof e!="undefined"?wevt=e:window.event&&(wevt=window.event),o||wevt&&(wevt.shiftKey||wevt.metaKey||e&&e.which==2))return o?(window.open("https://"+t+s,"_blank"),!1):!0;if(wevt&&(wevt.shiftKey||wevt.metaKey||e&&e.which==1))switch(e.stopPropagation(),i){case"insertShortcut":RYMsearch.insertShortcut(l,n);break;case"catalog":RYMsearch.openCatalog(l,r,c);break;case"addToList":RYMsearch.openAddToList(l,r,c);break;default:window.location="https://"+t+s}return!1},populateSelectGroup:function(e,a){var t=!1,s=$("#ui_search_object_select_"+e),l=new Array,r=new Array,c=null,n=0;for(var o in RYMsearch.types){var i=RYMsearch.types[o],u=null;for(var m in i){var f=i[m].type,p=i[m].label,_=o.toLowerCase();(t||a==_)&&(l.indexOf(_)==-1&&(l.push(_),u=$('<optgroup label="'+o+'"></optgroup>'),c||(c=f)),u.append($('<option value="'+f+'">'+p+"</option>")),n++)}u&&r.push(u)}for(var b in r)s.html(r[b]);s.val(c)}};
 
var s=(i,a,e)=>new Promise((t,o)=>{var _=n=>{try{l(e.next(n))}catch(d){o(d)}},c=n=>{try{l(e.throw(n))}catch(d){o(d)}},l=n=>n.done?t(n.value):Promise.resolve(n.value).then(_,c);l((e=e.apply(i,a)).next())});var RYMtextarea={init:function(i){return s(this,null,function*(){var a=$(i).data("id"),e=$("#"+a),t=e.data("autoresize")||!1,o=$("#ui_textarea_tool_bold_"+a),_=$("#ui_textarea_tool_italic_"+a),c=$("#ui_textarea_tool_image_"+a),l=$("#ui_textarea_tool_embed_"+a),n=$("#ui_textarea_embed_insert_"+a),d=$("#ui_textarea_tool_link_"+a),v=$("#ui_textarea_link_insert_"+a),m=$("#ui_textarea_tool_tips_"+a),h="ontouchstart"in window;o.unbind().on("click",function(r){RYMtextarea.onClickBold($(e),r)}),_.unbind().on("click",function(r){RYMtextarea.onClickItalic($(e),r)}),c.unbind().on("click",function(r){RYMtextarea.onClickImage($(e),r)}),l.unbind().on("click",function(r){RYMtextarea.onClickEmbed($(e),r)}),n.unbind().on("click",function(r){RYMtextarea.onClickEmbedInsert($(e),r)}),d.unbind().on("click",function(r){RYMtextarea.onClickLink($(e),r)}),v.unbind().on("click",function(r){RYMtextarea.onClickLinkInsert($(e),r)}),m.unbind().on("click",function(r){RYMtextarea.onClickTips($(e),r)}),t&&e.on("input",function(r){RYMtextarea._autoResize(e,r)});var u;typeof window.rym_search_test_server!="undefined"?u={id:"ui_textarea_search_"+a,default_scope:window.rym_scope,test_server:window.rym_search_test_server,config_string:window.rym_search_config_string,callback:"insertShortcut",callback_id:a}:u={id:"ui_textarea_search_"+a,default_scope:window.rym_scope,callback:"insertShortcut",callback_id:a};let f=yield renderTemplate("ui.search",u);$("#ui_textarea_search_frame_"+a).html(f)})},_autoResize:function(i,a){return;var e,t,o,_,c,l,n},insertFormatTag:function(i,a,e){var t=i[0],o=t.scrollTop;if(document.selection){var _=document.selection.createRange().text;t.focus();var c=document.selection.createRange();c.text=a+_+e}else if(t.selectionStart|t.selectionStart==0){t.selectionEnd>t.value.length&&(t.selectionEnd=t.value.length);var l=t.selectionStart,n=t.selectionEnd+a.length;t.value=t.value.slice(0,l)+a+t.value.slice(l),t.value=t.value.slice(0,n)+e+t.value.slice(n),t.selectionStart=l+a.length,t.selectionEnd=n,t.focus()}t.scrollTop=o},onClickBold:function(i,a){var e=$(i).data("id"),t=$("#"+e);RYMtextarea.insertFormatTag(t,"[b]","[/b]")},onClickItalic:function(i,a){var e=$(i).data("id"),t=$("#"+e);RYMtextarea.insertFormatTag(t,"[i]","[/i]")},onClickImage:function(i,a){var e=$(i).data("id");$("#ui_textarea_link_"+e).hide(),$("#ui_textarea_embed_"+e).hide(),$("#ui_textarea_image_"+e).slideToggle(100)},onClickEmbed:function(i,a){var e=$(i).data("id");$("#ui_textarea_link_"+e).hide(),$("#ui_textarea_image_"+e).hide(),$("#ui_textarea_embed_"+e).slideToggle(100),$("#ui_textarea_embed_error_"+e).hide()},onClickEmbedInsert:function(i,a){var e=$(i).data("id"),t=$("#ui_textarea_embed_input_"+e).val();rym.request.post("UiValidateEmbedCode",{id:e,text:t},null,"script")},_embedCodeSuccessCallback:function(i,a){RYMtextarea.insertFormatTag($("#"+i),a,""),$("#ui_textarea_embed_input_"+i).val(""),$("#ui_textarea_embed_"+i).hide()},_embedCodeFailureCallback:function(i,a){$("#ui_textarea_embed_error_"+i).text(a).hide().fadeIn(200)},_imageUploadCallback:function(i,a,e){var t="[image:"+a+"]";RYMtextarea.insertFormatTag($("#"+i),t,"")},onClickLink:function(i,a){var e=$(i).data("id");$("#ui_textarea_image_"+e).hide(),$("#ui_textarea_embed_"+e).hide(),$("#ui_textarea_link_"+e).slideToggle(100),$("#ui_textarea_link_error_"+e).hide()},onClickLinkInsert:function(i,a){var e=$(i).data("id"),t=$("#ui_textarea_link_url_"+e).val(),o=$("#ui_textarea_link_name_"+e).val();$("#ui_textarea_link_error_"+e).hide(),t.indexOf("https://")!=0&&t.indexOf("http://")!=0?$("#ui_textarea_link_error_"+e).text("The link you entered is not valid.  Please use a link that starts with http:// or https://").fadeIn(200):o.length>0?RYMtextarea.insertFormatTag($("#"+e),"["+t+","+o+"]",""):RYMtextarea.insertFormatTag($("#"+e),t,"")},onClickTips:function(i,a){var e=$(i).data("id");$("#ui_textarea_help_"+e).slideToggle(100)}};$.fn.extend({textareaUI:function(){$(this).each(function(i){RYMtextarea.init($(this))})}}),rymQ(function(){$(".ui_textarea").textareaUI()});
 
 
