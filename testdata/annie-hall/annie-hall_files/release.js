var RYMrating=function(t,e,s){this.type=t,this.assoc_id=e,this.rating=s,this.uiRating=s,this.touchReferenceX=null,this.setStars(this.rating),this.loading=!1,this.isTouch=!1;var s=this;$("#my_catalog_rating_"+t+"_"+e).on("keypress",function(a){a.keyCode>=48&&a.keyCode<=57?a.keyCode==48?s.setRating(10):s.setRating(a.keyCode-48):a.keyCode==45&&s.setRating(0)})};RYMrating.prototype.ratingFromMousePos=function(t){return t<=12?0:t>94?10:Math.floor(1+(t-12)/9)},RYMrating.prototype._ratingCallback=function(t,e){this.rating=t,this.uiRating=t,this.setStars(t),this.loading=!1,$("#my_catalog_rating_"+this.type+"_"+this.assoc_id)[0].className="my_catalog_rating",e&&$("#bump_btn_"+this.type+"_"+this.assoc_id).addClass("bumpable").text("Bump").show()},RYMrating.prototype.setRating=function(t){if(this.loading||this.rating==t)return;let e=document.getElementById("track_rating_status");typeof track_ratings_autosave!="undefined"&&track_ratings_autosave&&this.type==="z"&&e&&(e.className="saving"),this.type=="l"||this.type=="F"||this.type=="V"||this.type=="Z"?($("#my_catalog_rating_"+this.type+"_"+this.assoc_id)[0].className="my_catalog_rating loading",this.loading=!0,rym.request.post("CatalogSetRating",{type:this.type,assoc_id:this.assoc_id,rating:t},null,"script")):(this.rating=t,this.onChange(this.assoc_id,t),$("#my_catalog_rating_"+this.type+"_"+this.assoc_id)[0].className="my_catalog_rating")},RYMrating.prototype.setStars=function(t){this.uiRating=t,t==0?$("#rating_num_"+this.type+"_"+this.assoc_id).text("---"):$("#rating_num_"+this.type+"_"+this.assoc_id).text((t/2).toFixed(1)),document.getElementById("rating_stars_"+this.type+"_"+this.assoc_id).className="rating_stars star-"+t+"m"},RYMrating.prototype.onMouseMove=function(t,e){if(!this.loading&&!this.isTouch){var s=t.pageX||t.clientX+document.documentElement.scrollLeft,a=s-$(e).offset().left,o=this.ratingFromMousePos(a);this.setStars(o)}},RYMrating.prototype.onTouchStart=function(t,e){if(this.isTouch=!0,!this.loading){var s=t.touches.item(0);this.touchReferenceX=s.clientX,this.touchReferenceRating=this.rating,t.preventDefault()}},RYMrating.prototype.onTouchMove=function(t,e){if(!this.loading){var s=t.touches.item(0),a=s.clientX-this.touchReferenceX,o=Math.floor(a/9),n=this.touchReferenceRating+o;n<0?n=0:n>10&&(n=10),this.setStars(n),t.preventDefault()}},RYMrating.prototype.onTouchEnd=function(t,e){this.loading||this.setRating(this.uiRating)},RYMrating.prototype.onClick=function(t,e){if(!this.isTouch&&!this.loading){var s=t.pageX||t.clientX+document.documentElement.scrollLeft,a=s-$(e).offset().left,o=this.ratingFromMousePos(a);this.setRating(o),this.rating=o}},RYMrating.prototype.onMouseOver=function(t,e){this.loading||this.isTouch||($("#my_catalog_rating_"+this.type+"_"+this.assoc_id).focus()[0].className="my_catalog_rating inrate")},RYMrating.prototype.onMouseOut=function(t,e){this.loading||this.isTouch||(this.setStars(this.rating),$("#my_catalog_rating_"+this.type+"_"+this.assoc_id)[0].className="my_catalog_rating")};var RYMtags=function(t,e,s){this.type=t,this.assoc_id=e,this.tags=s};RYMtags.prototype.updateBtn=function(){},RYMtags.prototype._callback=function(t,e){e.length>0?($("#tags_text_"+this.type+"_"+this.assoc_id).html(e),$("#tag_btn_"+this.type+"_"+this.assoc_id)[0].className="tag_btn has_tags"):($("#tags_text_"+this.type+"_"+this.assoc_id).html("Tags"),$("#tag_btn_"+this.type+"_"+this.assoc_id)[0].className="tag_btn")},RYMtags.prototype.save=function(){var t=$("#tags_"+this.type+"_"+this.assoc_id).val();$("#tags_text_"+this.type+"_"+this.assoc_id).text("Saving..."),$("#tag_dlg_"+this.type+"_"+this.assoc_id).hide(),rym.request.post("CatalogSetTags",{type:this.type,assoc_id:this.assoc_id,tags:t})};var RYMcatalog=function(t,e,s,a){this.type=t,this.assoc_id=e,this.ownership=s,this.format=a};RYMcatalog.prototype.setOwnership=function(t){this.ownership!=t&&(rym.request.post("CatalogSetOwnership",{type:this.type,assoc_id:this.assoc_id,ownership:t}),$("#catalog_text_"+this.type+"_"+this.assoc_id).text("Saving...")),$(".catalog_btn_options_"+this.type+"_"+this.assoc_id).hide()},RYMcatalog.prototype._ownershipCallback=function(t,e,s,a,o){$("#catalog_text_"+this.type+"_"+this.assoc_id).text(s),this.ownership=t,this.format=e,document.getElementById("catalog_"+this.type+"_"+this.assoc_id).className="catalog_btn catalog_"+t,t=="n"?$("#my_catalog_format_"+this.type+"_"+this.assoc_id).hide():($("#format_text_"+this.type+"_"+this.assoc_id).text(a),$("#my_catalog_format_"+this.type+"_"+this.assoc_id).show()),o&&$("#bump_btn_"+this.type+"_"+this.assoc_id).addClass("bumpable").text("Bump").show()},RYMcatalog.prototype._formatCallback=function(t,e){this.format=t,$("#format_text_"+this.type+"_"+this.assoc_id).text(e)},RYMcatalog.prototype.setFormat=function(t){this.format!=t&&(rym.request.post("CatalogSetFormat",{type:this.type,assoc_id:this.assoc_id,format:t}),$("#format_text_"+this.type+"_"+this.assoc_id).text("Saving..."),$(".format_btn_options").hide())},RYMcatalog.prototype._bumpCallback=function(t){$("#catalog_date_inner_"+this.type+"_"+this.assoc_id).text(t),$("#bump_btn_"+this.type+"_"+this.assoc_id).removeClass("bumpable").text("bumped")},RYMcatalog.prototype.bump=function(){confirm("This will bump your rating, catalog, and review to today's date.  Are you sure?")&&rym.request.post("CatalogBump",{type:this.type,assoc_id:this.assoc_id})};var RYMreview=function(t,e,s,a,o,n,r){this.type=t,this.assoc_id=e,this.title=s,this.body=a,this.attribution=o,this.pub_visible=n,this.supplement=r,this.modified=!1,this.empty=s.length==0&&a.length==0&&o.length==0&&r.length==0,typeof $("#review_btn")[0]!="undefined"&&(this.empty?$("#review_btn")[0].className="review_btn":$("#review_btn")[0].className="review_btn has_review")};RYMreview.prototype.onClickPublish=function(t,e){var s=$("#review_publish").is(":checked");s?$("#published_rules").fadeIn(100):$("#published_rules").fadeOut(100),this.onChangeReviewField(t,e)},RYMreview.prototype.onChangeReviewField=function(t,e){$("#review_save_btn").attr("disabled",!1),this.modified=!0},RYMreview.prototype.edit=function(t,e){$("#my_review").removeClass("view_mode").addClass("edit_mode")},RYMreview.prototype.remove=function(t,e){confirm("Are you sure you want to delete your review?  This cannot be undone.")&&rym.request.post("CatalogSetReview",{type:this.type,assoc_id:this.assoc_id,title:"",pub_visible:!1,body:"",supplement:"",attribution:""})},RYMreview.prototype.toggleSection=function(t,e){if($("#my_track_ratings").is(":visible")){track_ratings.cancel()&&$("#my_review").slideToggle(100);return}if($("#my_more_info").is(":visible")){more_info.cancel()&&$("#my_review").slideToggle(100);return}$("#my_review").slideToggle(100)},RYMreview.prototype._callback=function(t,e,s,a,o,n,r,l,_){this.modified=!1,this.title=e,this.body=s,this.supplement=a,this.attribution=o,this.pub_visible=n,this.empty=e.length==0&&s.length==0&&o.length==0&&a.length==0,this.empty?($("#saved_review_inner").html(""),$("#review_shell_std_"+t).hide(),$("#my_review").removeClass("view_mode").addClass("edit_mode").slideToggle(100),$("#my_catalog")[0].scrollIntoView({behavior:"smooth"}),$("#review_btn")[0].className="review_btn"):($("#my_review").removeClass("edit_mode").addClass("view_mode"),n=="t"?$("#review_shell_std_"+t).html(l).show():$("#review_shell_std_"+t).html(l).hide(),$("#saved_review_inner").html(r),$("#my_catalog")[0].scrollIntoView({behavior:"smooth"}),$("#review_btn")[0].className="review_btn has_review"),_&&$("#bump_btn_"+this.type+"_"+this.assoc_id).addClass("bumpable").text("Bump").show()},RYMreview.prototype.save=function(){var t=$("#review_title").val(),e=$("#review_publish").is(":checked"),s=$("#review_body").val(),a=$("#review_supplement").val(),o=$("#review_attribution").val();rym.request.post("CatalogSetReview",{type:this.type,assoc_id:this.assoc_id,title:t,pub_visible:e,body:s,supplement:a,attribution:o})},RYMreview.prototype.preview=function(){var t=$("#review_title").val(),e=$("#review_publish").is(":checked"),s=$("#review_body").val(),a=$("#review_supplement").val(),o=$("#review_attribution").val();rym.request.post("CatalogPreviewReview",{type:this.type,assoc_id:this.assoc_id,title:t,pub_visible:e,body:s,supplement:a,attribution:o})},RYMreview.prototype.cancelEdit=function(t,e){return this.modified?confirm("Are you sure you want to cancel your review edit?  Any changes you made to your review will be lost.")?($("#review_title").val(this.title),$("#review_body").val(this.body),$("#review_supplement").val(this.supplement),$("#review_attribution").val(this.attribution),$("#review_publish").attr("checked",this.pub_visible=="t"),this.modified=!1,this.empty?($("#my_review").hide(),$("#my_catalog")[0].scrollIntoView({behavior:"smooth"})):($("#my_review").removeClass("edit_mode").addClass("view_mode"),$("#my_catalog")[0].scrollIntoView({behavior:"smooth"})),!0):!1:(this.empty?$("#my_review").slideToggle(100):$("#my_review").removeClass("edit_mode").addClass("view_mode"),$("#my_catalog")[0].scrollIntoView({behavior:"smooth"}),!0)};var RYMtrackRatings=function(t,e,s){this.type=t,this.assoc_id=e,this.ratings=s,this.newRatings=JSON.parse(JSON.stringify(s)),this.modified=!1};RYMtrackRatings.prototype.updateButton=function(){var t=!0,e=this.ratings;for(var s in e)if(e[s].rating&&e[s].rating>0){t=!1;break}typeof $("#track_rating_btn")[0]!="undefined"&&(t?$("#track_rating_btn")[0].className="track_rating_btn":$("#track_rating_btn")[0].className="track_rating_btn has_ratings")},RYMtrackRatings.prototype.onChange=function(t,e){this.newRatings[t].rating=e,$("#track_ratings_save_btn").attr("disabled",!1),$("#track_ratings_cancel_btn").attr("disabled",!1),$("#track_rating_success").hide(),this.modified=!0},RYMtrackRatings.prototype.toggleSection=function(t,e){if($("#my_review").is(":visible")){review.cancelEdit()&&($("#my_track_ratings").show(),$("#my_review").hide());return}if($("#my_more_info").is(":visible")){more_info.cancel()&&$("#my_track_ratings").slideToggle(100);return}$("#my_track_ratings").toggle()},RYMtrackRatings.prototype.cancel=function(t,e){if(this.modified){if(confirm("You have not saved your track ratings.  Are you sure you want to leave this section?")){var s=this.ratings;for(i in s)window["rating_z_"+i].setRating(s[i].rating),window["rating_z_"+i].setStars(s[i].rating);return document.documentElement.id!=="page_song"&&$("#my_track_ratings").slideToggle(100),$("#track_ratings_save_btn").attr("disabled",!0),$("#track_ratings_cancel_btn").attr("disabled",!0),!0}}else return document.documentElement.id!=="page_song"&&$("#my_track_ratings").slideToggle(100),$("#track_ratings_save_btn").attr("disabled",!0),$("#track_ratings_cancel_btn").attr("disabled",!0),!0;return!1},RYMtrackRatings.prototype.deleteAll=function(t,e){confirm("Are you sure you want to delete your track ratings?  This cannot be undone.")},RYMtrackRatings.prototype._callback=function(){$("#track_ratings_save_btn").attr("disabled",!0),$("#track_rating_success").show(),$("#track_ratings_cancel_btn").attr("disabled",!0);let t=document.getElementById("track_rating_status");typeof track_ratings_autosave!="undefined"&&track_ratings_autosave&&t&&(t.className="saved"),this.ratings=JSON.parse(JSON.stringify(this.newRatings)),this.modified=!1,this.updateButton()},RYMtrackRatings.prototype.save=function(t,e){var s=JSON.stringify(this.newRatings);rym.request.post("CatalogSetTrackRatings",{type:this.type,assoc_id:this.assoc_id,track_ratings:s},null,"script")};var RYMmoreInfo=function(t,e,s,a){this.type=t,this.assoc_id=e,this.acq_date=s,this.notes=a;var o=s.length==0&&a.length==0;o||($("#more_btn")[0].className="more_btn has_more")};RYMmoreInfo.prototype.toggleSection=function(){if($("#my_track_ratings").is(":visible")){track_ratings.cancel()&&$("#my_more_info").slideToggle(100);return}if($("#my_review").is(":visible")){review.cancelEdit()&&$("#my_more_info").slideToggle(100);return}$("#my_more_info").slideToggle(100)},RYMmoreInfo.prototype.cancel=function(){return $("#my_more_info").hide(),!0},RYMmoreInfo.prototype.onChangeAcqDate=function(t){$("#acq_date_save_btn").attr("disabled",!1),$("#acq_date_success").hide()},RYMmoreInfo.prototype.onChangeNotes=function(t){$("#notes_save_btn").attr("disabled",!1),$("#notes_success").hide()},RYMmoreInfo.prototype.saveNotes=function(){var t=$("#notes").val();rym.request.post("CatalogSetNotes",{type:this.type,assoc_id:this.assoc_id,notes:t},null,"script")},RYMmoreInfo.prototype._notesCallback=function(t){this.notes=t,$("#notes_save_btn").attr("disabled",!0),$("#notes_success").fadeIn(100);var e=this.acq_date.length==0&&this.notes.length==0;e?$("#more_btn")[0].className="more_btn":$("#more_btn")[0].className="more_btn has_more"},RYMmoreInfo.prototype.saveAcqDate=function(){var t=$("#acq_date").val();rym.request.post("CatalogSetAcquisitionDate",{type:this.type,assoc_id:this.assoc_id,acq_date:t},null,"script")},RYMmoreInfo.prototype._acqDateCallback=function(t){this.acq_date=t,$("#acq_date_save_btn").attr("disabled",!0),$("#acq_date_success").fadeIn(100);var e=this.acq_date.length==0&&this.notes.length==0;e?$("#more_btn")[0].className="more_btn":$("#more_btn")[0].className="more_btn has_more"};var RYMmediaPage={trackCreditsShown:!1,vol:1,toggleTrackCredits:function(t){RYMmediaPage.trackCreditsShown?(document.getElementById(t).className="tracklisting tracks",$("#track_credit_show_link_"+t).text($("#track_credit_show_msg_"+t).text())):(document.getElementById(t).className="tracklisting tracks allcredits",$("#track_credit_show_link_"+t).text($("#track_credit_hide_msg_"+t).text())),RYMmediaPage.trackCreditsShown=!RYMmediaPage.trackCreditsShown},playPreview:function(t,e){var s='<audio id="playerel" onvolumechange="RYMmediaPage.vol = volume" controls autoplay src="'+t+'" type="audio/mp4"></audio>',a='<object width="320" height="32" type="application/x-shockwave-flash" data="http://75a0d5d34b40760eb8e8-3b38f1c3334d8ecc77d364d763c0b5e6.r42.cf1.rackcdn.com/flashmediaelement.swf">';a+='<param name="movie" value="http://75a0d5d34b40760eb8e8-3b38f1c3334d8ecc77d364d763c0b5e6.r42.cf1.rackcdn.com/flashmediaelement.swf" /> ',a+='<param name="flashvars" value="autoplay=true&controls=true&amp;file='+t+'" /></object>';var o=document.createElement("audio");typeof o!="undefined"&&o.canPlayType&&o.canPlayType("audio/mp4").replace(/no/,"")?$("#track_preview_"+e).html(s):$("#track_preview_"+e).html(a),document.getElementById("playerel")&&(document.getElementById("playerel").volume=RYMmediaPage.vol),o=null},toggleIssues:function(t){var e=$("#expand_button").data("state");e==="compact"?($("#expand_button").data("state","expanded"),$("#expand_button").text($("#issue_expand_text_compact").text()),$(".issues").addClass("expanded")):($("#expand_button").data("state","compact"),$("#expand_button").text($("#issue_expand_text_expand").text()),$(".issues").removeClass("expanded"))},navCatalog:function(t,e,s,a,o){rym.request.post("LoadCatalogPage",{type:t,assoc_id:e,show_all:s,pane:a,page_str:o},null,"script")},onClickReviewPublish:function(t,e){$("#review_publish").is(":checked")?$("#published_rules").fadeIn(200):$("#published_rules").hide(100)},selectCatalogPane:function(t,e,s,a){$(".rating_info_tab").removeClass("active"),$("#rating_info_"+a).addClass("active"),RYMmediaPage.navCatalog(t,e,s,a,1)},deleteCatalog:function(t){confirm("Are you sure you want to delete this catalog entry?  This cannot be undone.")},toggleReviewHelp:function(t,e,s){var a=$("#review_help_"+e),o=$(t).position();s?a.css("top",o.top+30+"px").css("left",o.left-150+"px").show():a.hide()},_voteCallback:function(t,e){$("#review_voting_"+t).html(e)},reviewVoteRemove:function(t,e){rym.request.post("ReviewVoteRemove",{type:t,review_id:e},null,"script")},reviewVote:function(t,e,s){rym.request.post("ReviewVote",{type:t,review_id:e,vote:s},null,"script")},reviewBookmark:function(t,e){rym.request.post("ReviewBookmark",{type:t,review_id:e},null,"script")},setSortOrder:function(t){rym.request.post("SetReviewSortOrder",{sort_order:t},null,"script")}};
